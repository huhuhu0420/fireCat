<!DOCTYPE html>
<html lang="en">

<head>
  <title>firecat</title>
  <link rel="stylesheet" href="../static/chat.css">
</head>

<body>
  <div class="upbar">

    <div class="logoAndInput">

      <div class="logo">
        <a href="https://www.google.com/webhp?hl=zh-TW&amp;sa=X&amp;ved=0ahUKEwji76by_Yf8AhXVO3AKHQLHDdIQPAgI"
          title="Google é¦–é " id="logo">
          <img src="https://www.google.com/images/branding/googlelogo/2x/googlelogo_light_color_92x30dp.png"
            style="background:none" alt="Google" height="30" width="92" data-atf="1" data-frt="0">
        </a>
      </div>
      <div class="searchinput">
        <input class="searchinput" type="text" name="user" id="input" />
        <button class="submit" id="submit">
          ğŸ”
        </button>
      </div>
    </div>
    <div class="searchType">
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>
      <a href="https://www.youtube.com/watch?v=XA-D0jY0Z9w">
        <button class="searchType">
          ğŸ”å…¨éƒ¨
        </button>
      </a>

    </div>
  </div>
  <!-- /<img src="{{url_for('static', filename='chattitle.png')}}" /> -->
  <div class='chatroom'>

    <ul id="context">


    </ul>

  </div>
</body>
<script>
  function send() {
    console.log("send")
    let text = document.querySelector("#input").value
    let data = {
      "name": "client1",
      "text": text,
    }
    console.log(data)
    let xhr = new XMLHttpRequest()
    xhr.open("POST", "/post")
    xhr.setRequestHeader('Content-type', 'application/json');
    xhr.send(JSON.stringify(data))
  }
  function update() {
    let xhr = new XMLHttpRequest()
    xhr.open("GET", "/get")
    xhr.send()
    xhr.onload = () => {
      console.log("update scuss")
      let data = JSON.parse(xhr.response)
      console.log(data)
      let block = document.querySelector("#context")
      block.innerHTML = ""

      data.forEach(element => {
        buf = ''
        for (const key in element) {
          if (key == 'text') {
            block.innerHTML += "<li >" + "<h3>" + element[key] + buf;
          } else {
            buf += " - " + element[key] + "</h3 " + "</li > ";
            buf += '<li class="text">1.2. ä»€éº¼æ˜¯GNU/Linuxï¼Ÿ ... ä½œæ¥­ç³»çµ±ç”±è¨±å¤šåŸºç¤ç¨‹å¼çµ„æˆï¼Œå®ƒå€‘æ˜¯è®“é›»è…¦æ¥å—ä½¿ç”¨è€…æŒ‡ä»¤ä¸¦èˆ‡ä¹‹æºé€šçš„å¿…è¦ç¨‹å¼ï¼›è®€å–è³‡æ–™æˆ–å°‡å…¶å¯«å…¥ç¡¬ç¢Ÿã€ç£å¸¶æˆ–å°è¡¨æ©Ÿï¼›æ§åˆ¶è¨˜æ†¶é«”çš„ä½¿ç”¨ï¼›Â ...</li>'
          }
        }
      });
    };

  }
  document.querySelector("#submit").addEventListener("click", send)
  setInterval(update, 100);
</script>

</html>